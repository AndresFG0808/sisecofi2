# PROMPT PARA AN√ÅLISIS Y CREACI√ìN DE INFORME DE SOLUCI√ìN - SISTEMA SISECOFI

‚ö†Ô∏è **IMPORTANTE**: Este prompt se enfoca en an√°lisis y resumen de soluciones.
Los informes JSON se generan manualmente por el usuario, NO autom√°ticamente por el asistente.

## ‚ö†Ô∏è CONTEXTO CR√çTICO - FLUJO DE SOLUCI√ìN ‚ö†Ô∏è

**Este prompt est√° dise√±ado para analizar hallazgos y proporcionar res√∫menes de soluci√≥n t√©cnica.**

**FLUJO OBLIGATORIO:**
1. **ANALIZAR** la documentaci√≥n ECU/EIU/CRN para entender el comportamiento esperado
2. **IDENTIFICAR** el microservicio, archivos y c√≥digo involucrado
3. **PROPONER** la soluci√≥n t√©cnica espec√≠fica
4. **GENERAR** resumen t√©cnico detallado con datos para JSON (NO crear JSON autom√°ticamente)
5. **PROPORCIONAR** los campos espec√≠ficos para que el usuario llene manualmente el JSON

**IMPORTANTE:** Los datos se proporcionan como resumen estructurado para llenado manual del JSON.
Usar "N/A" para campos que no aplican seg√∫n el tipo de cambio (frontend-only, backend-only, etc.).

---

## ESTRUCTURA DE TRABAJO

### FASE 1: AN√ÅLISIS DOCUMENTAL (OBLIGATORIO)
Antes de proponer cualquier soluci√≥n, debes:

1. **BUSCAR DOCUMENTACI√ìN:**
   - ECU (Especificaci√≥n de Caso de Uso) - L√≥gica de negocio
   - EIU (Especificaci√≥n Interfaz de Usuario) - Campos y validaciones
   - CRN (Cat√°logo de Reglas de Negocio) - RNA espec√≠ficas
   
2. **EXTRAER INFORMACI√ìN ESPEC√çFICA:**
   - Ubicaci√≥n exacta en PDF (p√°gina + coordenadas Aspose)
   - Texto LITERAL tal cual aparece
   - Reglas de negocio aplicables (RNA)
   - Flujos principales y alternos
   - Mensajes definidos (MSG)

### FASE 2: AN√ÅLISIS DE C√ìDIGO
1. **IDENTIFICAR MICROSERVICIO:**
   - Determinar cu√°l microservicio maneja la funcionalidad
   - Puerto real del servicio (application.properties)
   - PATH_BASE (Constantes.java)

2. **UBICAR ARCHIVOS ESPEC√çFICOS:**
   - Controllers (endpoint espec√≠fico)
   - Services (l√≥gica de negocio)
   - Entities (modelo de datos)
   - Repositories (acceso a datos)

3. **ANALIZAR COMPORTAMIENTO ACTUAL:**
   - C√≥digo que causa el hallazgo
   - L√≠neas espec√≠ficas a modificar
   - Dependencias involucradas

### FASE 3: PROPUESTA DE SOLUCI√ìN
1. **DEFINIR CAMBIOS ESPEC√çFICOS:**
   - Archivos exactos a modificar
   - M√©todos o l√≠neas espec√≠ficas
   - Nuevas validaciones a implementar
   - Cambios en l√≥gica de negocio

2. **VALIDAR CONTRA DOCUMENTACI√ìN:**
   - Asegurar que los cambios cumplan ECU/EIU
   - Verificar cumplimiento de RNA
   - Confirmar mensajes correctos

### FASE 4: GENERACI√ìN DEL INFORME
Generar un JSON siguiendo EXACTAMENTE la estructura de `datos-ejemplo.json`

---

## FORMATO DE RESPUESTA REQUERIDO

El asistente debe proporcionar los datos estructurados para que el usuario complete manualmente el JSON, siguiendo esta estructura:

### üìã DATOS PARA EL INFORME JSON

**INFORMACI√ìN GENERAL:**
- Fecha de implementaci√≥n: [fecha]
- Descripci√≥n corta: [m√°ximo 100 caracteres]
- Descripci√≥n detallada: [an√°lisis completo con referencias ECU/EIU/CRN]

**ARQUITECTURA:**
- Microservicio(s): [nombre] o "N/A" si es solo frontend
- Puerto(s): [n√∫mero] o "N/A" si es solo frontend  
- Rutas de prueba: [URLs completas] o "N/A" si es solo frontend

**BASE DE DATOS:**
- Base de datos: [nombre] o "N/A" si no aplica
- Tablas involucradas: [lista] o "N/A" si no aplica
- Columnas modificadas: [lista] o "N/A" si no aplica

**ESTADO DEL CAMBIO:** [PENDIENTE/SOLUCIONADO/ANALIZADO/FALSO_POSITIVO]

**ARCHIVOS MODIFICADOS:**
Cantidad total: [n√∫mero]
1. [nombre_archivo] - L√≠nea X: [descripci√≥n del cambio]

**PRUEBAS REALIZADAS:**
Cantidad: [n√∫mero]
1. [descripci√≥n de la prueba]

**DESCRIPCI√ìN DEL PROBLEMA Y LA SOLUCI√ìN:**
[Resumen t√©cnico de problema, causa, soluci√≥n e impacto]

---

## FORMATO DEL INFORME DE SOLUCI√ìN (REFERENCIA PARA EL USUARIO)

```json
{
  "nombreReporte": "Solucion_[Modulo]_[Funcionalidad]",
  "descripcion_corta": "[Resumen del problema solucionado en 1 l√≠nea]",
  "descripcion_detallada": "[Explicaci√≥n t√©cnica completa de qu√© se modific√≥ y por qu√©]",
  "descripcion_problema_solucion_input": [
    "[Descripci√≥n del problema espec√≠fico encontrado]",
    "[Explicaci√≥n de la soluci√≥n implementada]",
    "[Beneficios o mejoras obtenidas]"
  ],
  "microservicio_input": ["[NombreMicroservicio]"],
  "puerto_input": ["[PuertoReal]"],
  "ruta_input": ["[RutaEndpointCompleta]"],
  "base_datos": "[NombreBaseDatos]",
  "tablas_input": ["[tabla1]", "[tabla2]"],
  "columnas_input": ["[campo1]", "[campo2]"],
  "estado": "SOLICIONADO",
  "cantidad_archivos": "[NumeroArchivosModificados]",
  "cantidad_pruebas": "[NumeroPruebasRealizadas]",
  "pruebas_realizadas": [
    {
      "numero": 1,
      "descripcion": "[Descripci√≥n de la prueba realizada]",
      "detalles": [
        {"texto": "[Detalle espec√≠fico de la prueba]"}
      ],
      "tabla_datos": [
        {
          "key": "[nombreCampo]",
          "type": "Text",
          "value": "[valorPrueba]"
        }
      ]
    }
  ],
  "modificaciones": [
    {
      "numero": 1,
      "titulo": "[NombreArchivoModificado.java]",
      "lineas": [
        {"texto": "[Descripci√≥n espec√≠fica del cambio realizado]"},
        {"texto": "[Otra modificaci√≥n en el mismo archivo]"}
      ]
    }
  ]
}
```

---

## REGLAS ESPEC√çFICAS PARA EL INFORME

### üö® **REGLA GENERAL DE CAMPOS OPCIONALES**
**IMPORTANTE:** Cuando una soluci√≥n NO requiere ciertos campos, usar `"N/A"` o `["N/A"]` seg√∫n el tipo de campo.

**Casos comunes para usar N/A:**
- **Cambios solo de frontend** ‚Üí `microservicio_input: ["N/A"]`, `puerto_input: ["N/A"]`, `ruta_input: ["N/A"]`
- **Sin tablas de BD involucradas** ‚Üí `base_datos: "N/A"`, `tablas_input: ["N/A"]`, `columnas_input: ["N/A"]`
- **Sin pruebas de microservicio** ‚Üí `tabla_datos: []` (array vac√≠o)

### 1. CAMPO "nombreReporte"
**Formato:** `Solucion_[Hallazgo#]_[ModuloFuncionalidad]`
**Ejemplo:** `Solucion_Hallazgo4_AsignarProyectos`

### 2. CAMPO "descripcion_corta"
**M√°ximo:** 100 caracteres
**Formato:** Descripci√≥n directa del problema solucionado
**Ejemplo:** `Se corrigi√≥ el campo 'Id proyecto' para que sea solo informativo seg√∫n especificaci√≥n EIU`

### 3. CAMPO "descripcion_detallada"
**Incluir:**
- Problema espec√≠fico encontrado
- Discrepancia con documentaci√≥n
- Cambios t√©cnicos realizados
- Referencias a ECU/EIU/RNA

### 4. CAMPO "microservicio_input"
**Valores v√°lidos:**
- `"AdminContratos"`
- `"AdminDevengados"`
- `"AdminGeneral"`
- `"Catalogos"`
- `"Proveedores"`
- `"Proyectos"`
- `"ReporteDocumental"`
- `"WebSerCfdi"`
- `"WebSerDirectorioActivo"`

**‚ö†Ô∏è IMPORTANTE:** Para cambios √öNICAMENTE de frontend (React/Vue/Angular), usar `["N/A"]`

### 5. CAMPO "puerto_input"
**Obtener de:** `src/main/resources/application.properties`
**Buscar:** `server.port=[NUMERO]`
**Formato:** `["9191"]` (como string entre comillas)

**‚ö†Ô∏è IMPORTANTE:** Para cambios √öNICAMENTE de frontend (React/Vue/Angular), usar `["N/A"]`

### 6. CAMPO "ruta_input"
**Formato:** Ruta completa para localhost
**Estructura:** `http://localhost:[PUERTO][PATH_BASE][endpoint]`
**Ejemplo:** `["http://localhost:9191/asignar-proyecto/buscar"]`

**‚ö†Ô∏è IMPORTANTE:** Para cambios √öNICAMENTE de frontend (React/Vue/Angular), usar `["N/A"]`

### 7. CAMPO "modificaciones"
**OBLIGATORIO:** Incluir TODOS los archivos analizados durante la investigaci√≥n
**IMPORTANTE:** Registrar archivos SIEMPRE, independientemente si requieren cambios o no

**Tipos de archivos a incluir:**
- **Frontend**: React/Vue/Angular (.jsx, .vue, .ts, etc.)
- **Backend**: Controllers, Services, Entities (.java, .cs, etc.)  
- **Base de datos**: Scripts SQL, migrations, schemas
- **Documentaci√≥n**: ECU/EIU/CRN analizados (.md, .pdf)
- **Configuraci√≥n**: Properties, YAML, JSON de config
- **Informes**: JSONs de soluci√≥n creados/modificados

**Para cada archivo:**
- `titulo`: Nombre exacto del archivo con extensi√≥n
- `lineas`: Array con descripci√≥n del an√°lisis realizado o cambio implementado

**Ejemplo para archivo SIN modificaciones (solo an√°lisis):**
```json
{
  "numero": 1,
  "titulo": "ComponenteEjemplo.jsx",
  "lineas": [
    {"numero": 45, "texto": "An√°lisis de validaci√≥n - Comportamiento actual correcto seg√∫n EIU"},
    {"numero": 67, "texto": "Revisi√≥n de l√≥gica existente - No requiere modificaciones"}
  ]
}
```

**Ejemplo para archivo CON modificaciones:**
**Ejemplo para archivo CON modificaciones:**
```json
{
  "numero": 2,
  "titulo": "AsignarProyectoCtl.java",
  "lineas": [
    {"numero": 127, "texto": "Modificar endpoint buscarProyecto para validar entrada"},
    {"numero": 145, "texto": "Agregar validaci√≥n de campo requerido"}
  ]
}
```

### 8. CAMPO "pruebas_realizadas"
**INCLUIR:**
- Prueba antes del cambio (demostrar el problema)
- Prueba despu√©s del cambio (demostrar la soluci√≥n)
- Pruebas de regresi√≥n si aplican

**‚ö†Ô∏è IMPORTANTE:** Para cambios √öNICAMENTE de frontend, la `tabla_datos` puede contener solo datos de prueba de UI, no necesariamente datos de microservicio

**Formato tabla_datos:**
```json
{
  "key": "nombreCampo",
  "type": "Text|Number|Boolean|File",
  "value": "valorEjemplo"
}
```

---

## üé® **CASOS ESPEC√çFICOS POR TIPO DE CAMBIO**

### **üì± CAMBIOS √öNICAMENTE DE FRONTEND**
Cuando la soluci√≥n involucra SOLO archivos frontend (React/Vue/Angular):

```json
{
  "microservicio_input": ["N/A"],
  "puerto_input": ["N/A"], 
  "ruta_input": ["N/A"],
  "base_datos": "N/A",
  "tablas_input": ["N/A"],
  "columnas_input": ["N/A"],
  "pruebas_realizadas": [
    {
      "tabla_datos": []  // Array vac√≠o o datos de UI solamente
    }
  ]
}
```

### **‚öôÔ∏è CAMBIOS DE BACKEND + FRONTEND**
Cuando involucra microservicio + frontend:

```json
{
  "microservicio_input": ["NombreMicroservicio"],
  "puerto_input": ["9191"],
  "ruta_input": ["http://localhost:9191/endpoint"],
  "base_datos": "sisecofi",
  "tablas_input": ["tabla1", "tabla2"],
  "columnas_input": ["campo1", "campo2"]
}
```

---

## PROCESO OBLIGATORIO PASO A PASO

### PASO 1: RECIBIR HALLAZGO Y ENTENDER CONTEXTO
**Input del usuario:** Descripci√≥n del hallazgo a solucionar
**Acci√≥n:** Analizar el problema reportado

### PASO 2: BUSCAR DOCUMENTACI√ìN RELACIONADA
**Usar herramientas:**
- `file_search` para encontrar ECU/EIU/CRN
- `grep_search` para localizar secciones espec√≠ficas
- `read_file` para extraer textos exactos

**Extraer:**
- Comportamiento esperado seg√∫n documentaci√≥n
- Reglas de negocio aplicables (RNA)
- Mensajes definidos (MSG)

### PASO 3: ANALIZAR C√ìDIGO ACTUAL
**Identificar:**
- Microservicio responsable
- Controllers y m√©todos espec√≠ficos
- Services con l√≥gica de negocio
- Entidades y campos involucrados

**Usar herramientas:**
- `read_file` para examinar c√≥digo
- `grep_search` para buscar implementaciones

### PASO 4: PROPONER SOLUCI√ìN T√âCNICA
**Especificar:**
- Archivos exactos a modificar
- L√≠neas de c√≥digo a cambiar
- Nuevas validaciones a implementar
- Cambios en frontend si aplican

### PASO 5: GENERAR INFORME JSON
**Seguir EXACTAMENTE** el formato de `datos-ejemplo.json`
**Incluir TODOS** los campos obligatorios
**Usar valores reales** obtenidos del an√°lisis

### PASO 6: PROPONER PRUEBAS DE VALIDACI√ìN
**Definir:**
- Datos de prueba espec√≠ficos
- URLs completas para Postman
- Pasos de validaci√≥n en frontend
- Criterios de aceptaci√≥n

---

## VALIDACIONES OBLIGATORIAS ANTES DE ENTREGAR

### ‚úÖ CHECKLIST DE DOCUMENTACI√ìN
- [ ] ECU analizado y citado con p√°gina exacta
- [ ] EIU analizado y citado con p√°gina exacta  
- [ ] CRN consultado para RNA aplicables
- [ ] Textos copiados literalmente (no parafraseados)
- [ ] Coordenadas Aspose incluidas

### ‚úÖ CHECKLIST DE C√ìDIGO
- [ ] Microservicio identificado correctamente
- [ ] Puerto real extra√≠do de application.properties
- [ ] PATH_BASE verificado en Constantes.java
- [ ] Archivos espec√≠ficos ubicados
- [ ] M√©todos y l√≠neas exactas identificadas

### ‚úÖ CHECKLIST DE SOLUCI√ìN
- [ ] Cambios espec√≠ficos definidos
- [ ] Soluci√≥n alineada con documentaci√≥n
- [ ] Impacto en otros m√≥dulos evaluado
- [ ] Validaciones necesarias identificadas

### ‚úÖ CHECKLIST DEL JSON
- [ ] Estructura id√©ntica a `datos-ejemplo.json`
- [ ] Todos los campos obligatorios completos
- [ ] Arrays con formato correcto
- [ ] Valores realistas y verificables
- [ ] Pruebas detalladas con datos espec√≠ficos
- [ ] **Campos N/A aplicados correctamente seg√∫n tipo de cambio**
- [ ] **Microservicio N/A si es solo frontend**
- [ ] **Puerto/Rutas N/A si es solo frontend**
- [ ] **Tablas BD N/A si no aplican**

---

## EJEMPLO DE RESPUESTA ESPERADA

### üìã AN√ÅLISIS DEL HALLAZGO: Campo "Id proyecto" editable cuando debe ser informativo

#### 1Ô∏è‚É£ DOCUMENTACI√ìN RELACIONADA

**üìÑ ECU - 17_3083_ECU_AsignarProyectos:**
- **P√°gina PDF:** 12
- **Coordenadas:** `_page11_x102.00_y518.92`
- **Flujo Principal Paso 8:** "El sistema auto-genera el identificador de proyecto..."

**üñ•Ô∏è EIU - 17_3083_EIU_AsignarProyectos:**
- **P√°gina PDF:** 5  
- **Coordenadas:** `_page4_x215.00_y342.15`
- **Campo:** Id proyecto - Tipo: Num√©rico - Obligatorio: No - **Modo: Solo lectura**

#### 2Ô∏è‚É£ AN√ÅLISIS DE C√ìDIGO

**Microservicio:** Proyectos
**Puerto:** 9191
**Archivo:** AsignarProyectoCtl.java
**Problema:** Campo permite edici√≥n en frontend cuando debe ser readonly

#### 3Ô∏è‚É£ SOLUCI√ìN PROPUESTA

**Archivos a modificar:**
1. `AsignarProyectoCtl.java` - L√≠nea 45: Agregar readonly attribute
2. `AsignarProyectoServImp.java` - L√≠nea 28: Validar que no se edite manualmente
3. `asignar-proyecto.component.html` - L√≠nea 12: Cambiar input a readonly

#### 4Ô∏è‚É£ INFORME JSON GENERADO

```json
{
  "nombreReporte": "Solucion_Hallazgo4_AsignarProyectos",
  "descripcion_corta": "Campo Id proyecto corregido a solo lectura seg√∫n especificaci√≥n EIU",
  "descripcion_detallada": "Se identific√≥ que el campo 'Id proyecto' permit√≠a edici√≥n manual cuando la documentaci√≥n EIU especifica que debe ser solo informativo. Se modific√≥ el frontend para aplicar readonly y el backend para validar que no se reciban valores editados manualmente.",
  // ... resto del JSON completo
}
```

---

## INSTRUCCIONES FINALES

**üö® MUY IMPORTANTE:**
1. **NO MODIFIQUES NING√öN ARCHIVO** hasta que el usuario confirme el informe
2. **SIEMPRE ANALIZA DOCUMENTACI√ìN PRIMERO** antes del c√≥digo
3. **USA COORDENADAS EXACTAS** para referencias de PDF
4. **SIGUE EL FORMATO JSON** de `datos-ejemplo.json` exactamente
5. **INCLUYE PRUEBAS DETALLADAS** para validar la soluci√≥n

**El informe debe ser TAN ESPEC√çFICO** que otro desarrollador pueda implementar los cambios exactos siguiendo √∫nicamente la informaci√≥n proporcionada.

---

## üìù **EJEMPLOS DE APLICACI√ìN**

### **Ejemplo 1: Cambio Solo Frontend**
```json
{
  "nombreReporte": "Solucion_Hallazgo5_CampoValidacion",
  "microservicio_input": ["N/A"],
  "puerto_input": ["N/A"],
  "ruta_input": ["N/A"],
  "base_datos": "N/A",
  "tablas_input": ["N/A"],
  "columnas_input": ["N/A"],
  "modificaciones": [
    {
      "titulo": "FormularioUsuario.jsx",
      "lineas": [
        {"numero": 45, "texto": "Agregar validaci√≥n de email en campo input"}
      ]
    }
  ]
}
```

### **Ejemplo 2: Cambio Backend + Frontend**
```json
{
  "nombreReporte": "Solucion_Hallazgo6_ValidacionBD",
  "microservicio_input": ["Usuarios"],
  "puerto_input": ["8080"],
  "ruta_input": ["http://localhost:8080/api/usuarios/validar"],
  "base_datos": "sisecofi",
  "tablas_input": ["usuarios", "perfiles"],
  "columnas_input": ["email", "activo"]
}
```

---

## USO DEL PROMPT

**Para usar este prompt:**

```
HALLAZGO A SOLUCIONAR: [Descripci√≥n del problema]

M√ìDULO: [ej: Proyectos/Asignar proyectos]  
FUNCIONALIDAD: [ej: B√∫squeda por proyecto]
COMPORTAMIENTO ACTUAL: [Lo que hace ahora]
COMPORTAMIENTO ESPERADO: [Lo que deber√≠a hacer]

[Proporcionar im√°genes si las hay]
```

**El asistente seguir√° autom√°ticamente todos los pasos y generar√° el informe completo.**